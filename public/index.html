<!doctype html>
<html>
<head>
  <title>Motion Connect</title>
  <style>
    body { font-family: sans-serif; text-align: center; margin-top: 50px; }
    button { font-size: 18px; padding: 10px 20px; }
    #token { font-weight: bold; }
  </style>
</head>
<body>
  <button id="start">Start &amp; Connect</button>
  <p>Your token: <span id="token">â€”</span></p>
  <script>
    let token = '';
    document.getElementById('start').onclick = async () => {
      const resp = await fetch('/connect', { method: 'POST' });
      const body = await resp.json();
      token = body.token;
      document.getElementById('token').textContent = token;
      startSending();
    };
    function startSending() {
      window.addEventListener('devicemotion', e => {
        const x = e.acceleration.x || 0;
        const y = e.acceleration.y || 0;
        navigator.sendBeacon('/update', JSON.stringify({ token, x, y }));
      }, true);
    }
  </script>
</body>
</html>
